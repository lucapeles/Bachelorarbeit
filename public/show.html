<!DOCTYPE html>
<html lang="de">

<head>
    <meta charset="UTF-8">
    <title>Spielansicht</title>
    <link rel="stylesheet" href="/css/showStyle.css"> <!-- CSS einbinden -->
</head>

<body>
    <!-- Oberer Bereich -->
    <div class="questionText">
        <h1 id="questionText">Aufgabenanzeige</h1>
    </div>

    <!-- Unterer Bereich -->
    <div class="bottom-section">
        <!-- Linker Bereich -->
        <div class="left-box">
            <p>Hier erscheint das Diagramm.</p>
        </div>

        <!-- Rechter Bereich -->
        <div class="right-box">
            <div class="timer">30 Sekunden</div>
            <div class="progress-bar">
                <div class="progress-bar-inner" id="progressBar"></div>
            </div>
        </div>
    </div>

    <script src="/socket.io/socket.io.js"></script>
    <script>
        const socket = io();

        // Neue Frage anzeigen
        socket.on("newTask", (task) => {
            const questionTextContainer = document.querySelector(".questionText");
            questionTextContainer.style.backgroundColor = "#f4f4f4"; // Hintergrund auf Standard zurücksetzen (weiß)
            document.getElementById("questionText").textContent = task.description;
        });

        // Korrekte Lösung anzeigen
        socket.on("taskCompleted", (correctAnswer) => {
            const questionTextContainer = document.querySelector(".questionText");
            questionTextContainer.style.backgroundColor = "#d4edda"; // Hintergrund grün setzen
            document.getElementById("questionText").textContent = correctAnswer;
        });


        // Fortschrittsbalken
        let duration = 30; // Sekunden
        let currentProgress = 100; // Start bei 100%

        function updateProgressBar() {
            const progressBarInner = document.getElementById('progressBar');
            const timer = document.querySelector('.timer');

            const interval = setInterval(() => {
                if (currentProgress <= 0) {
                    clearInterval(interval); // Stoppt die Aktualisierung
                } else {
                    currentProgress -= 100 / duration;
                    progressBarInner.style.height = `${currentProgress}%`;
                    timer.textContent = `${Math.ceil((duration * currentProgress) / 100)} Sekunden`;
                }
            }, 1000);
        }

        window.onload = updateProgressBar;
    </script>
</body>

</html>